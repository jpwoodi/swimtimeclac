<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swimming</title>
    <link rel="icon" href="images/swimming_favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://raw.githubusercontent.com/jpwoodi/swimtimeclac/2b6290fea10bcf90c5230f878fb3116be7d4e29a/people-2588747.jpg');
            background-size: cover;
            background-position: center;
            color: #212529;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

              /* Style for the top navigation bar */
        .top-nav {
            width: 100%;
            background-color: #007BFF;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            display: flex;
            justify-content: center;
        }

        .top-nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .top-nav ul li {
            padding: 14px 20px;
        }

        .top-nav ul li a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            font-family: 'Poppins', sans-serif;
        }

        .top-nav ul li a:hover {
            background-color: #0056b3;
            color: white;
            border-radius: 5px;
        }

        /* Add padding to your main content to avoid being hidden by the fixed nav */
        .container {
            margin-top: 60px;
        }

        @media (max-width: 768px) {
            .top-nav ul {
                flex-direction: column;
                align-items: center;
            }

            .top-nav ul li {
                padding: 10px;
            }
        }
    .strava-feed {
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 10px;
        margin-top: 20px;
    }

    .activity {
        margin-bottom: 10px;
        padding: 10px;
        border-bottom: 1px solid #ccc;
    }
    
    
    
    
    </style>
  </head>
    <body>

    <!-- Navigation Menu -->
    <nav class="top-nav">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="calculator.html">Time and Pace Calculator</a></li>
            <li><a href="pools.html">London Swim Locations</a></li>
        </ul>
    </nav>
    
    <div id="strava-feed" class="strava-feed">
    <h2>My Strava Swims</h2>
    <div id="activities"></div>
        
</div>

        <script>
    const CLIENT_ID = 'process.env.CLIENT_ID_STRAVA';
    const CLIENT_SECRET = 'process.env.CLIENT_SECRET_STRAVA';
    const REDIRECT_URI = 'process.env.REDIRECT_URI_STRAVA'; // 

    // Redirect to Strava for authorization
    function authenticateStrava() {
        const authUrl = `https://www.strava.com/oauth/authorize?client_id=${CLIENT_ID}&response_type=code&redirect_uri=${REDIRECT_URI}&scope=activity:read_all`;
        window.location.href = authUrl;
    }

    // Handle the OAuth callback
    async function handleCallback() {
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');

        if (code) {
            // Exchange code for access token
            const tokenResponse = await fetch('https://www.strava.com/oauth/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    client_id: CLIENT_ID,
                    client_secret: CLIENT_SECRET,
                    code: code,
                    grant_type: 'authorization_code'
                }),
            });

            const tokenData = await tokenResponse.json();
            const accessToken = tokenData.access_token;

            // Fetch the user's activities
            fetchActivities(accessToken);
        }
    }

    // Fetch and display activities
    async function fetchActivities(accessToken) {
        const response = await fetch('https://www.strava.com/api/v3/athlete/activities', {
            headers: {
                'Authorization': `Bearer ${accessToken}`,
            },
        });

        const activities = await response.json();
        const activitiesContainer = document.getElementById('activities');

        // Display activities on the page
        activities.forEach(activity => {
            const activityElement = document.createElement('div');
            activityElement.classList.add('activity');
            activityElement.innerHTML = `<strong>${activity.name}</strong> - ${activity.distance} meters`;
            activitiesContainer.appendChild(activityElement);
        });
    }

    // Call handleCallback when the page loads
    window.onload = handleCallback;
</script>


    </body>
</html>
